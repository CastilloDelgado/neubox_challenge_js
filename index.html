<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neubox Challenge</title>
</head>

<body>
    <div class="container p-3 text-center">
        <div class="row justify-content-center">
            <div class="col-5 px-3 py-5 m-3 rounded" style="background-color: rgb(255, 187, 187)">
                <p class="h3">Problema 1</p>
                <label for="input1">Ingresa un archivo .txt</label><br>
                <input type="file" accept=".txt" id="input1" name="input1">
            </div>
            <div class="col-5 px-3 py-5 m-3 rounded" style="background-color: rgb(163, 206, 255)">
                <p class="h3">Problema 2</p>
                <label for="input2">Ingresa un archivo .txt</label><br>
                <input type="file" accept=".txt" id="input2" name="input2">
            </div>
        </div>
    </div>
</body>

<script type="text/javascript">

    // Solución al Problema 1 - Se ejecuta cuando agregas el archivo
    document.getElementById('input1').addEventListener('change', function () {
        var fr = new FileReader();
        fr.onload = function () {
            // Dividir texto por lineas
            let lines = fr.result.split('\n');

            // Limpiar los caracteres duplicados en la cadena
            let stringClean = lines[3].split('').reduce((acc, cur, index) => {
                if (acc.length >= 1 && acc[acc.length - 1] !== cur) return acc + cur
                return acc
            })

            // Eliminamos los caracteres especiales
            lines[1] = lines[1].replace(/[^a-zA-Z ]/g, "")
            lines[2] = lines[2].replace(/[^a-zA-Z ]/g, "")

            // Guardamos los resultados en una cadena
            let result = (stringClean.indexOf(lines[1]) === -1 ? "NO" : "YES") + "\n" + (stringClean.indexOf(lines[2]) === -1 ? "NO" : "YES")

            // Creamos el archivo de salida
            var element = document.createElement('a');
            element.setAttribute('href', 'data:text/plant;charset=utf-8,' + encodeURIComponent(result))
            element.setAttribute('download', 'output.txt')
            document.body.appendChild(element)
            element.click()
            document.body.removeChild(element)
        }

        fr.readAsText(this.files[0]);
    })

    // Solución al Problema 2 - Se ejecuta cuando agregas el archivo
    document.getElementById('input2').addEventListener('change', function () {
        var fr = new FileReader();
        fr.onload = function () {
            // Dividir texto en lineas
            let lines = fr.result.split('\n');
            let winner = "";
            let bestScore = 0;
            lines.forEach((line, index) => {
                if (index !== 0) {
                    let values = line.split(' ')
                    let score = values[0] - values[1] < 0 ? (values[0] - values[1]) * -1 : values[0] - values[1]

                    if (score > bestScore) {
                        bestScore = score;
                        winner = values[0] - values[1] < 0 ? "2" : "1"
                    }
                }
            })

            // Guardamos el resultado en una variable
            let result = winner + " " + bestScore

            // Creamos el archivo de salida
            var element = document.createElement('a');
            element.setAttribute('href', 'data:text/plant;charset=utf-8,' + encodeURIComponent(result))
            element.setAttribute('download', 'output.txt')
            document.body.appendChild(element)
            element.click()
            document.body.removeChild(element)
        }

        fr.readAsText(this.files[0]);
    })
</script>

</html>